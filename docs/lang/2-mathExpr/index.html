<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Math. expressions - INScore Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="/css/inscore.css" rel="stylesheet" />
        <link href="/css/pubs.css" rel="stylesheet" />
        <link href="/BNF/railroad-diagrams.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Math. expressions";
        var mkdocs_page_input_path = "lang/2-mathExpr.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> INScore Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="#">Messages</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/1-introduction/">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/2-genformat/">Format of a message</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/3-common/">Common Messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/4-time/">Time Messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/5-miscmsgs/">Miscellaneous</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/6-setsect/">The set Message</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/7-getsect/">The get Message</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/8-specificMsg/">Specific Messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/9-ITL/">Application Messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/10-scene/">Scene Messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/11-forwarding/">Messages Forwarding</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/12-layers/">Layers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/13-mapping/">Mapping</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/14-syncmsg/">Synchronization</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/15-graphsig/">Graphic signals</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/16-sensors/">Sensors</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/17-interaction/">Events</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/18-scoreExpr/">Score Expressions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/19-plugins/">Plugins</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/20-changes/">Changes list</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/">Index</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Scripting language</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../1-scripting/">Language</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Math. expressions</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#operators">Operators</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#arguments">Arguments</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#polymorphism">Polymorphism</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#numeric-values">Numeric values</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#strings">Strings</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#arrays">Arrays</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../3-appendices/">Grammar</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">INScore Web</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../web/1-introduction/">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../web/2-mainDiffs/">Global changes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../web/3-unsupported/">Unsupported messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../web/4-behavior/">Behavioral changes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../web/5-newMessages/">Specific messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../web/6-MIDI/">MIDI support</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../web/7-audioObjects/">Audio objects</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../web/8-communication/">Communication</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Documents</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="http://berio.grame.fr/MusicNotation/Introduction-to-INScore/">Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../rsrc/INScoreMessages.pdf">Messages reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../rsrc/INScoreLang.pdf">Language reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../rsrc/INScoreWeb.pdf">Web reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../papers/">Papers</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Download</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://github.com/grame-cncm/inscore/releases">INScore</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../about/">About</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">INScore Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>Reference &raquo;</li>
          <li>Scripting language &raquo;</li>
      <li>Math. expressions</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <script src='/BNF/railroad-diagrams.js'></script>

<h1 id="mathematical-expressions">Mathematical expressions</h1>
<p><a name="mathExpr"></a></p>
<p>Since INScore version 1.20, mathematical expressions have been introduced as messages arguments. These expressions allows to compute values at parsing time.</p>
<h2 id="operators">Operators</h2>
<p><a name="Operators"></a></p>
<p>Basic mathematical expressions are supported. They are listed below.</p>
<p><a name="2-mathExpr-operators"></a></p>
<div class="rail">
<span class="railtitle">mathexpr</span>
<br /><script>
ComplexDiagram(
    Choice (0, Sequence (Comment ('1'), NonTerminal('matharg'), '+', NonTerminal('matharg')), Sequence (Comment ('2'), NonTerminal('matharg'), '-', NonTerminal('matharg')), Sequence (Comment ('3'), '-', NonTerminal('matharg')), Sequence (Comment ('4'), NonTerminal('matharg'), '*', NonTerminal('matharg')), Sequence (Comment ('5'), NonTerminal('matharg'), '/', NonTerminal('matharg')), Sequence (Comment ('6'), NonTerminal('matharg'), '%', NonTerminal('matharg')), Sequence (Comment ('7'), '(', NonTerminal('mathexpr'), ')'), Sequence (Comment ('8'), 'max', '(', OneOrMore (NonTerminal('matharg')), ')'), Sequence (Comment ('9'), 'min', '(', OneOrMore (NonTerminal('matharg')), ')'), Sequence (Comment ('10'), '(', NonTerminal('mathbool'), '?', NonTerminal('matharg'), ':', NonTerminal('matharg'), ')'))
).addTo()
</script>
</div>

<p>Note that <em>matharg</em> could be a <em>mathexpr</em> as well (see section <a href="../2-mathExpr#mathargs">mathargs</a>).</p>
<ul>
<li><strong>1</strong>: addition.</li>
<li><strong>2</strong>: substraction.</li>
<li><strong>3</strong>: negation.</li>
<li><strong>4</strong>: multiplication.</li>
<li><strong>5</strong>: division.</li>
<li><strong>6</strong>: modulo.</li>
<li><strong>7</strong>: parenthesis, to be used for evaluation order.</li>
<li><strong>8</strong>: gives the maximum value.</li>
<li><strong>9</strong>: gives the minimum value.</li>
<li><strong>10</strong>: conditional form: returns the first <span class="OSC">matharg</span> if <span class="OSC">mathbool</span> is true, otherwise returns the second one.</li>
</ul>
<p><span class="example">Example</span>
Some simple mathematical expressions used as message parameters:</p>
<pre><code class="language-inscore">/ITL/scene/myObject x 0.5 * 0.2;
/ITL/scene/myObject y ($var ? 1 : -1);
</code></pre>
<p>Boolean operations are the following:</p>
<p><a name="2-mathExpr-booleans"></a></p>
<div class="rail">
<span class="railtitle">mathbool</span>
<br /><script>
ComplexDiagram(
    Choice (0, Sequence (Comment ('1'), NonTerminal('arg')), Sequence (Comment ('2'), '!', NonTerminal('arg')), Sequence (Comment ('3'), NonTerminal('arg'), '==', NonTerminal('arg')), Sequence (Comment ('4'), NonTerminal('arg'), '>', NonTerminal('arg')), Sequence (Comment ('5'), NonTerminal('arg'), '>=', NonTerminal('arg')), Sequence (Comment ('6'), NonTerminal('arg'), '<', NonTerminal('arg')), Sequence (Comment ('7'), NonTerminal('arg'), '<=', NonTerminal('arg')))
).addTo()
</script>
</div>

<ul>
<li><strong>1</strong>: evaluate the argument as a boolean value.</li>
<li><strong>2</strong>: evaluate the argument as a boolean value and negates the result.</li>
<li><strong>3</strong>: check if the arguments are equal.</li>
<li><strong>4</strong>: check if the first argument is greater than the second one.</li>
<li><strong>5</strong>: check if the first argument is greater or equel to the second one.</li>
<li><strong>6</strong>: check if the first argument is less than the second one.</li>
<li><strong>7</strong>: check if the first argument is less or equal to the second one.</li>
</ul>
<p><span class="example">Example</span>
Compare two variables:</p>
<pre><code class="language-inscore">/ITL/scene/myObject x ($var1 &gt; $var2 ? 1 : -1);
</code></pre>
<h2 id="arguments">Arguments</h2>
<p><a name="mathargs"></a></p>
<p>Arguments of mathematical operations are the following:</p>
<p><a name="2-mathExpr-arguments"></a></p>
<div class="rail">
<span class="railtitle">matharg</span>
<br /><script>
ComplexDiagram(
    Choice (0, Sequence (Comment ('1'), 'param'), Sequence (Comment ('2'), 'variable'), Sequence (Comment ('3'), 'variable', Choice (0, '++', '--')), Sequence (Comment ('4'), Choice (0, '++', '- -'), 'variable'), Sequence (Comment ('5'), 'msgvariable'), Sequence (Comment ('6'), NonTerminal('mathexpr')))
).addTo()
</script>
</div>

<ul>
<li><strong>1</strong>: any message parameter.</li>
<li><strong>2</strong>: a variable value.</li>
<li><strong>3</strong>: a variable that is post incremented or post decremented.</li>
<li><strong>4</strong>: a variable that is pre incremented or pre decremented.</li>
<li><strong>5</strong>: a message based variable.</li>
<li><strong>6</strong>: a mathematical expression.</li>
</ul>
<h2 id="polymorphism">Polymorphism</h2>
<p><a name="mathpoly"></a></p>
<p>Since INScore's parameters are polymorphic, the semantic of the operations are to be defined notably when applied to non numeric arguments. Actually, a basic OSC message parameter type is between <span class="OSC">int32</span>, <span class="OSC">float32</span> and <span class="OSC">string</span>. However, due to the extension of the scripting language, parameters could also be arrays of any type, including mixed types (e.g. resulting from variable declarations). </p>
<h3 id="numeric-values">Numeric values</h3>
<p><a name="numbers"></a></p>
<p>For numeric arguments, automatic type conversion is applied with a precedence of <span class="OSC">float32</span> i.e. when one of the argument's type is  <span class="OSC">float32</span>, the result is also  <span class="OSC">float32</span> (see Table <a href="../2-mathExpr#table:mathopnum">table:mathopnum</a>).</p>
<p><a name="table:mathopnum"></a></p>
<table>
<thead>
<tr>
<th align="right">arg1</th>
<th>arg2</th>
<th align="center">output</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><span class="OSC">int32</span></td>
<td><span class="OSC">int32</span></td>
<td align="center"><span class="OSC">int32</span></td>
</tr>
<tr>
<td align="right"><span class="OSC">float32</span></td>
<td><span class="OSC">int32</span></td>
<td align="center"><span class="OSC">float32</span></td>
</tr>
<tr>
<td align="right"><span class="OSC">int32</span></td>
<td><span class="OSC">float32</span></td>
<td align="center"><span class="OSC">float32</span></td>
</tr>
<tr>
<td align="right"><span class="OSC">float32</span></td>
<td><span class="OSC">float32</span></td>
<td align="center"><span class="OSC">float32</span></td>
</tr>
</tbody>
</table>
<p><span class='caption'>Numeric operations output</span></p>
<h3 id="strings">Strings</h3>
<p><a name="strings"></a></p>
<p>For <span class="OSC">string</span> parameters, operations that have an obvious semantic (like + applied to two strings) are defined (see Table <a href="../2-mathExpr#table:mathopstr">table:mathopstr</a>) , the others are undefined and generate an error (see Table <a href="../2-mathExpr#table:mathnoopstr">table:mathnoopstr</a>). </p>
<p><a name="table:mathopstr"></a></p>
<table>
<thead>
<tr>
<th align="right">operation</th>
<th>evaluates to</th>
<th align="center">comment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><span class="OSC">string</span> + <span class="OSC">string</span></td>
<td><span class="OSC">string</span></td>
<td align="center">concatenate the two strings</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> + <span class="OSC">num</span></td>
<td><span class="OSC">string</span> + <em>string</em>(num)</td>
<td align="center"><span class="OSC">num</span> is converted to string</td>
</tr>
<tr>
<td align="right"><span class="OSC">num</span> + <span class="OSC">string</span></td>
<td><em>string</em>(num) + <span class="OSC">string</span></td>
<td align="center">"</td>
</tr>
<tr>
<td align="right">@max(<span class="OSC">string</span> <span class="OSC">string</span>)</td>
<td><span class="OSC">string</span></td>
<td align="center">select the largest string</td>
</tr>
<tr>
<td align="right">@min(<span class="OSC">string</span> <span class="OSC">string</span>)</td>
<td><span class="OSC">string</span></td>
<td align="center">select the smallest string</td>
</tr>
</tbody>
</table>
<p><span class='caption'>Supported operations on strings</span></p>
<p><a name="table:mathnoopstr"></a></p>
<table>
<thead>
<tr>
<th align="right">operation</th>
<th align="center">comment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><span class="OSC">string</span> <em>op</em> <span class="OSC">string</span></td>
<td align="center">where <em>op</em> is in [- * /</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> <em>op</em> <span class="OSC">num</span></td>
<td align="center">"</td>
</tr>
<tr>
<td align="right"><span class="OSC">num</span> <em>op</em> <span class="OSC">string</span></td>
<td align="center">"</td>
</tr>
<tr>
<td align="right">-<span class="OSC">string</span></td>
<td align="center"></td>
</tr>
<tr>
<td align="right">prefixed or postfixed <span class="OSC">string</span></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p><span class='caption'>Non supported operations on strings</span></p>
<p>Boolean operations are supported on <span class="OSC">string</span> only when both arguments are strings (see Table <a href="../2-mathExpr#table:mathboolstr">table:mathboolstr</a>). Other types combination generate an error.</p>
<p><a name="table:mathboolstr"></a></p>
<table>
<thead>
<tr>
<th align="right">boolean operation</th>
<th align="center">evaluated as</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><span class="OSC">string</span> == <span class="OSC">string</span></td>
<td align="center">regular strings comparison</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> &gt; <span class="OSC">string</span></td>
<td align="center">alphabetical strings comparison</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> &gt;= <span class="OSC">string</span></td>
<td align="center">"</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> &lt; <span class="OSC">string</span></td>
<td align="center">"</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> &lt;= <span class="OSC">string</span></td>
<td align="center">"</td>
</tr>
</tbody>
</table>
<p><span class='caption'>Supported boolean operations on strings</span></p>
<h3 id="arrays">Arrays</h3>
<p><a name="arrays"></a></p>
<p>For arrays, the operation is distributed inside the array elements:
<script type="math/tex; mode=display">
 arg op[v_1\ ...\ v_n]  := [arg\ op\ v_1\ ...\ arg\ op\ v_n] 
</script>
or
<script type="math/tex; mode=display"> 
[v_1 ...v_n]\ op\ arg  := [v_1\ op\ arg\ ...\ v_n\ op\ arg] 
</script>
</p>
<p>When both parameters are arrays, the operation is distributed from one array elements to the other array elements when the arrays have the same size and it generates an error when the sizes differ:
<script type="math/tex; mode=display">
[a_1 ...a_i]\ op\ [b_1\ ...\ b_i]  := [a_1\ op\ b_1\ ...\ a_i\ op\ b_i\ ] 
</script>
</p>
<p>Boolean operations on arrays are evaluated as the logical <script type="math/tex">and</script> of it's element's boolean values and generate an error when the arrays sizes differ.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../1-scripting/" class="btn btn-neutral float-left" title="Language"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../3-appendices/" class="btn btn-neutral float-right" title="Grammar">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p><a href="https://inscore.grame.fr">INscore projects</a> Copyright &copy; 2019-2021 <a href="http://www.grame.fr">Grame-CNCM</a></p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../1-scripting/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../3-appendices/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="/js/inscore.js" defer></script>
      <script src="/js/pubs.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>

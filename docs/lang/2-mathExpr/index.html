<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Math. expressions - INScore Documentation</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <link href="/css/inscore.css" rel="stylesheet">
        <link href="/css/pubs.css" rel="stylesheet">
        <link href="/BNF/railroad-diagrams.css" rel="stylesheet">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">INScore Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Messages</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../refs/1-introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../refs/2-genformat/" class="dropdown-item">Format of a message</a>
</li>
            
<li>
    <a href="../../refs/3-common/" class="dropdown-item">Common Messages</a>
</li>
            
<li>
    <a href="../../refs/4-time/" class="dropdown-item">Time Messages</a>
</li>
            
<li>
    <a href="../../refs/5-miscmsgs/" class="dropdown-item">Miscellaneous</a>
</li>
            
<li>
    <a href="../../refs/6-setsect/" class="dropdown-item">The set Message</a>
</li>
            
<li>
    <a href="../../refs/7-getsect/" class="dropdown-item">The get Message</a>
</li>
            
<li>
    <a href="../../refs/8-specificMsg/" class="dropdown-item">Specific Messages</a>
</li>
            
<li>
    <a href="../../refs/9-ITL/" class="dropdown-item">Application Messages</a>
</li>
            
<li>
    <a href="../../refs/10-scene/" class="dropdown-item">Scene Messages</a>
</li>
            
<li>
    <a href="../../refs/11-forwarding/" class="dropdown-item">Messages Forwarding</a>
</li>
            
<li>
    <a href="../../refs/12-layers/" class="dropdown-item">Layers</a>
</li>
            
<li>
    <a href="../../refs/13-mapping/" class="dropdown-item">Mapping</a>
</li>
            
<li>
    <a href="../../refs/14-syncmsg/" class="dropdown-item">Synchronization</a>
</li>
            
<li>
    <a href="../../refs/15-graphsig/" class="dropdown-item">Graphic signals</a>
</li>
            
<li>
    <a href="../../refs/16-sensors/" class="dropdown-item">Sensors</a>
</li>
            
<li>
    <a href="../../refs/17-interaction/" class="dropdown-item">Interaction</a>
</li>
            
<li>
    <a href="../../refs/18-scoreExpr/" class="dropdown-item">Score Expressions</a>
</li>
            
<li>
    <a href="../../refs/19-plugins/" class="dropdown-item">Plugins</a>
</li>
            
<li>
    <a href="../../refs/20-changes/" class="dropdown-item">Changes list</a>
</li>
            
<li>
    <a href="../../refs/" class="dropdown-item">Index</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Scripting language</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../1-scripting/" class="dropdown-item">Language</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Math. expressions</a>
</li>
            
<li>
    <a href="../3-appendices/" class="dropdown-item">Grammar</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">INScore Web</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../web/1-introduction/" class="dropdown-item">Introduction</a>
</li>
            
<li>
    <a href="../../web/2-behavior/" class="dropdown-item">Global changes</a>
</li>
            
<li>
    <a href="../../web/3-unsupported/" class="dropdown-item">Unsupported messages</a>
</li>
            
<li>
    <a href="../../web/4-newMessages/" class="dropdown-item">Specific messages</a>
</li>
            
<li>
    <a href="../../web/5-faustObjects/" class="dropdown-item">Faust objects</a>
</li>
            
<li>
    <a href="../../web/6-communication/" class="dropdown-item">Communication</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Documents <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="http://berio.grame.fr/MusicNotation/Introduction-to-INScore/" class="dropdown-item">Tutorial</a>
</li>
                                    
<li>
    <a href="../../rsrc/INScoreMessages.pdf" class="dropdown-item">Messages reference</a>
</li>
                                    
<li>
    <a href="../../rsrc/INScoreLang.pdf" class="dropdown-item">Language reference</a>
</li>
                                    
<li>
    <a href="../../rsrc/INScoreLang.pdf" class="dropdown-item">Web reference</a>
</li>
                                    
<li>
    <a href="../../papers/" class="dropdown-item">Papers</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Download <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="https://github.com/grame-cncm/inscore/releases" class="dropdown-item">INScore</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../1-scripting/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../3-appendices/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#mathematical-expressions" class="nav-link">Mathematical expressions</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#operators" class="nav-link">Operators</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#arguments" class="nav-link">Arguments</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#polymorphism" class="nav-link">Polymorphism</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<script src='/BNF/railroad-diagrams.js'></script>

<h1 id="mathematical-expressions">Mathematical expressions</h1>
<p><a name="mathExpr"></a></p>
<p>Since INScore version 1.20, mathematical expressions have been introduced as messages arguments. These expressions allows to compute values at parsing time.</p>
<h2 id="operators">Operators</h2>
<p><a name="Operators"></a></p>
<p>Basic mathematical expressions are supported. They are listed below.</p>
<p><a name="2-mathExpr-operators"></a></p>
<div class="rail">
<span class="railtitle">mathexpr</span>
<br /><script>
ComplexDiagram(
    Choice (0, Sequence (Comment ('1'), NonTerminal('matharg'), '+', NonTerminal('matharg')), Sequence (Comment ('2'), NonTerminal('matharg'), '-', NonTerminal('matharg')), Sequence (Comment ('3'), '-', NonTerminal('matharg')), Sequence (Comment ('4'), NonTerminal('matharg'), '*', NonTerminal('matharg')), Sequence (Comment ('5'), NonTerminal('matharg'), '/', NonTerminal('matharg')), Sequence (Comment ('6'), NonTerminal('matharg'), '%', NonTerminal('matharg')), Sequence (Comment ('7'), '(', NonTerminal('mathexpr'), ')'), Sequence (Comment ('8'), 'max', '(', OneOrMore (NonTerminal('matharg')), ')'), Sequence (Comment ('9'), 'min', '(', OneOrMore (NonTerminal('matharg')), ')'), Sequence (Comment ('10'), '(', NonTerminal('mathbool'), '?', NonTerminal('matharg'), ':', NonTerminal('matharg'), ')'))
).addTo()

</script>
</div>

<p>Note that <em>matharg</em> could be a <em>mathexpr</em> as well (see section <a href="../2-mathExpr#mathargs">mathargs</a>).</p>
<ul>
<li><strong>1</strong>: addition.</li>
<li><strong>2</strong>: substraction.</li>
<li><strong>3</strong>: negation.</li>
<li><strong>4</strong>: multiplication.</li>
<li><strong>5</strong>: division.</li>
<li><strong>6</strong>: modulo.</li>
<li><strong>7</strong>: parenthesis, to be used for evaluation order.</li>
<li><strong>8</strong>: gives the maximum value.</li>
<li><strong>9</strong>: gives the minimum value.</li>
<li><strong>10</strong>: conditional form: returns the first <span class="OSC">matharg</span> if <span class="OSC">mathbool</span> is true, otherwise returns the second one.</li>
</ul>
<p><span class="example">Example</span>
Some simple mathematical expressions used as message parameters:</p>
<pre><code class="language-inscore">/ITL/scene/myObject x 0.5 * 0.2;
/ITL/scene/myObject y ($var ? 1 : -1);
</code></pre>
<p>Boolean operations are the following:</p>
<p><a name="2-mathExpr-booleans"></a></p>
<div class="rail">
<span class="railtitle">mathbool</span>
<br /><script>
ComplexDiagram(
    Choice (0, Sequence (Comment ('1'), NonTerminal('arg')), Sequence (Comment ('2'), '!', NonTerminal('arg')), Sequence (Comment ('3'), NonTerminal('arg'), '==', NonTerminal('arg')), Sequence (Comment ('4'), NonTerminal('arg'), '>', NonTerminal('arg')), Sequence (Comment ('5'), NonTerminal('arg'), '>=', NonTerminal('arg')), Sequence (Comment ('6'), NonTerminal('arg'), '<', NonTerminal('arg')), Sequence (Comment ('7'), NonTerminal('arg'), '<=', NonTerminal('arg')))
).addTo()

</script>
</div>

<ul>
<li><strong>1</strong>: evaluate the argument as a boolean value.</li>
<li><strong>2</strong>: evaluate the argument as a boolean value and negates the result.</li>
<li><strong>3</strong>: check if the arguments are equal.</li>
<li><strong>4</strong>: check if the first argument is greater than the second one.</li>
<li><strong>5</strong>: check if the first argument is greater or equel to the second one.</li>
<li><strong>6</strong>: check if the first argument is less than the second one.</li>
<li><strong>7</strong>: check if the first argument is less or equal to the second one.</li>
</ul>
<p><span class="example">Example</span>
Compare two variables:</p>
<pre><code class="language-inscore">/ITL/scene/myObject x ($var1 &gt; $var2 ? 1 : -1);
</code></pre>
<h2 id="arguments">Arguments</h2>
<p><a name="mathargs"></a></p>
<p>Arguments of mathematical operations are the following:</p>
<p><a name="2-mathExpr-arguments"></a></p>
<div class="rail">
<span class="railtitle">matharg</span>
<br /><script>
ComplexDiagram(
    Choice (0, Sequence (Comment ('1'), 'param'), Sequence (Comment ('2'), 'variable'), Sequence (Comment ('3'), 'variable', Choice (0, '++', '--')), Sequence (Comment ('4'), Choice (0, '++', '- -'), 'variable'), Sequence (Comment ('5'), 'msgvariable'), Sequence (Comment ('6'), NonTerminal('mathexpr')))
).addTo()

</script>
</div>

<ul>
<li><strong>1</strong>: any message parameter.</li>
<li><strong>2</strong>: a variable value.</li>
<li><strong>3</strong>: a variable that is post incremented or post decremented.</li>
<li><strong>4</strong>: a variable that is pre incremented or pre decremented.</li>
<li><strong>5</strong>: a message based variable.</li>
<li><strong>6</strong>: a mathematical expression.</li>
</ul>
<h2 id="polymorphism">Polymorphism</h2>
<p><a name="mathpoly"></a></p>
<p>Since INScore's parameters are polymorphic, the semantic of the operations are to be defined notably when applied to non numeric arguments. Actually, a basic OSC message parameter type is between <span class="OSC">int32</span>, <span class="OSC">float32</span> and <span class="OSC">string</span>. However, due to the extension of the scripting language, parameters could also be arrays of any type, including mixed types (e.g. resulting from variable declarations). </p>
<h3 id="numeric-values">Numeric values</h3>
<p><a name="numbers"></a></p>
<p>For numeric arguments, automatic type conversion is applied with a precedence of <span class="OSC">float32</span> i.e. when one of the argument's type is  <span class="OSC">float32</span>, the result is also  <span class="OSC">float32</span> (see Table <a href="../2-mathExpr#table:mathopnum">table:mathopnum</a>).</p>
<p><a name="table:mathopnum"></a></p>
<table>
<thead>
<tr>
<th align="right">arg1</th>
<th>arg2</th>
<th align="center">output</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><span class="OSC">int32</span></td>
<td><span class="OSC">int32</span></td>
<td align="center"><span class="OSC">int32</span></td>
</tr>
<tr>
<td align="right"><span class="OSC">float32</span></td>
<td><span class="OSC">int32</span></td>
<td align="center"><span class="OSC">float32</span></td>
</tr>
<tr>
<td align="right"><span class="OSC">int32</span></td>
<td><span class="OSC">float32</span></td>
<td align="center"><span class="OSC">float32</span></td>
</tr>
<tr>
<td align="right"><span class="OSC">float32</span></td>
<td><span class="OSC">float32</span></td>
<td align="center"><span class="OSC">float32</span></td>
</tr>
</tbody>
</table>
<p><span class='caption'>Numeric operations output</span></p>
<h3 id="strings">Strings</h3>
<p><a name="strings"></a></p>
<p>For <span class="OSC">string</span> parameters, operations that have an obvious semantic (like + applied to two strings) are defined (see Table <a href="../2-mathExpr#table:mathopstr">table:mathopstr</a>) , the others are undefined and generate an error (see Table <a href="../2-mathExpr#table:mathnoopstr">table:mathnoopstr</a>). </p>
<p><a name="table:mathopstr"></a></p>
<table>
<thead>
<tr>
<th align="right">operation</th>
<th>evaluates to</th>
<th align="center">comment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><span class="OSC">string</span> + <span class="OSC">string</span></td>
<td><span class="OSC">string</span></td>
<td align="center">concatenate the two strings</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> + <span class="OSC">num</span></td>
<td><span class="OSC">string</span> + <em>string</em>(num)</td>
<td align="center"><span class="OSC">num</span> is converted to string</td>
</tr>
<tr>
<td align="right"><span class="OSC">num</span> + <span class="OSC">string</span></td>
<td><em>string</em>(num) + <span class="OSC">string</span></td>
<td align="center">"</td>
</tr>
<tr>
<td align="right">@max(<span class="OSC">string</span> <span class="OSC">string</span>)</td>
<td><span class="OSC">string</span></td>
<td align="center">select the largest string</td>
</tr>
<tr>
<td align="right">@min(<span class="OSC">string</span> <span class="OSC">string</span>)</td>
<td><span class="OSC">string</span></td>
<td align="center">select the smallest string</td>
</tr>
</tbody>
</table>
<p><span class='caption'>Supported operations on strings</span></p>
<p><a name="table:mathnoopstr"></a></p>
<table>
<thead>
<tr>
<th align="right">operation</th>
<th align="center">comment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><span class="OSC">string</span> <em>op</em> <span class="OSC">string</span></td>
<td align="center">where <em>op</em> is in [- * /</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> <em>op</em> <span class="OSC">num</span></td>
<td align="center">"</td>
</tr>
<tr>
<td align="right"><span class="OSC">num</span> <em>op</em> <span class="OSC">string</span></td>
<td align="center">"</td>
</tr>
<tr>
<td align="right">-<span class="OSC">string</span></td>
<td align="center"></td>
</tr>
<tr>
<td align="right">prefixed or postfixed <span class="OSC">string</span></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p><span class='caption'>Non supported operations on strings</span></p>
<p>Boolean operations are supported on <span class="OSC">string</span> only when both arguments are strings (see Table <a href="../2-mathExpr#table:mathboolstr">table:mathboolstr</a>). Other types combination generate an error.</p>
<p><a name="table:mathboolstr"></a></p>
<table>
<thead>
<tr>
<th align="right">boolean operation</th>
<th align="center">evaluated as</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><span class="OSC">string</span> == <span class="OSC">string</span></td>
<td align="center">regular strings comparison</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> &gt; <span class="OSC">string</span></td>
<td align="center">alphabetical strings comparison</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> &gt;= <span class="OSC">string</span></td>
<td align="center">"</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> &lt; <span class="OSC">string</span></td>
<td align="center">"</td>
</tr>
<tr>
<td align="right"><span class="OSC">string</span> &lt;= <span class="OSC">string</span></td>
<td align="center">"</td>
</tr>
</tbody>
</table>
<p><span class='caption'>Supported boolean operations on strings</span></p>
<h3 id="arrays">Arrays</h3>
<p><a name="arrays"></a></p>
<p>For arrays, the operation is distributed inside the array elements:
<script type="math/tex; mode=display">
 arg op[v_1\ ...\ v_n]  := [arg\ op\ v_1\ ...\ arg\ op\ v_n] 
</script>
or
<script type="math/tex; mode=display"> 
[v_1 ...v_n]\ op\ arg  := [v_1\ op\ arg\ ...\ v_n\ op\ arg] 
</script>
</p>
<p>When both parameters are arrays, the operation is distributed from one array elements to the other array elements when the arrays have the same size and it generates an error when the sizes differ:
<script type="math/tex; mode=display">
[a_1 ...a_i]\ op\ [b_1\ ...\ b_i]  := [a_1\ op\ b_1\ ...\ a_i\ op\ b_i\ ] 
</script>
</p>
<p>Boolean operations on arrays are evaluated as the logical <script type="math/tex">and</script> of it's element's boolean values and generate an error when the arrays sizes differ.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p><a href="https://inscore.grame.fr">INscore projects</a> Copyright &copy; 2019-2021 <a href="http://www.grame.fr">Grame-CNCM</a></p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
        <script src="/js/inscore.js" defer></script>
        <script src="/js/pubs.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

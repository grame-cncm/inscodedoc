<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Audio objects - INScore Documentation</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="/css/inscore.css" rel="stylesheet" />
        <link href="/css/pubs.css" rel="stylesheet" />
        <link href="/BNF/railroad-diagrams.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Audio objects";
        var mkdocs_page_input_path = "web/7-audioObjects.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> INScore Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="#">Messages</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/1-introduction/">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/2-genformat/">Format of a message</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/3-common/">Common Messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/4-time/">Time Messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/5-miscmsgs/">Miscellaneous</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/6-setsect/">The set Message</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/7-getsect/">The get Message</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/8-specificMsg/">Specific Messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/9-ITL/">Application Messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/10-scene/">Scene Messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/11-forwarding/">Messages Forwarding</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/12-layers/">Layers</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/13-mapping/">Mapping</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/14-syncmsg/">Synchronization</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/15-graphsig/">Graphic signals</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/16-sensors/">Sensors</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/17-interaction/">Events</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/18-scoreExpr/">Score Expressions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/19-plugins/">Plugins</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/20-changes/">Changes list</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../refs/">Index</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Scripting language</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../lang/1-scripting/">Language</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../lang/2-mathExpr/">Math. expressions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../lang/3-appendices/">Grammar</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">INScore Web</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../1-introduction/">Introduction</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../2-mainDiffs/">Global changes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../3-unsupported/">Unsupported messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../4-behavior/">Behavioral changes</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../5-newMessages/">Specific messages</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../6-MIDI/">MIDI support</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="./">Audio objects</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#audio-objects">Audio objects</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#faust-objects">Faust objects</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#creating-a-faust-object">Creating a Faust object</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#faust-messages">Faust messages</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#faust-objects-parameters">Faust objects parameters</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#polyphonic-objects">Polyphonic objects</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#audio-input-output">Audio Input / Output</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#audio-input">Audio Input</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../8-communication/">Communication</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Documents</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="http://berio.grame.fr/MusicNotation/Introduction-to-INScore/">Tutorial</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../rsrc/INScoreMessages.pdf">Messages reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../rsrc/INScoreLang.pdf">Language reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../rsrc/INScoreWeb.pdf">Web reference</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../papers/">Papers</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Download</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://github.com/grame-cncm/inscore/releases">INScore</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../about/">About</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">INScore Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a> &raquo;</li>
          <li>Reference &raquo;</li>
          <li>INScore Web &raquo;</li>
      <li>Audio objects</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <script src='/BNF/railroad-diagrams.js'></script>

<h1 id="audio">Audio</h1>
<p><a name="audioObjects"></a></p>
<h2 id="audio-objects">Audio objects</h2>
<p><a name="audioObjects"></a></p>
<p>Audio objects are <strong>connectable</strong> objects i.e. objects which output can be connected to the input of another audio object. In the INScore model, the following objects are audio objects: <span class="OSC">audio</span>, <span class="OSC">video</span>, <span class="OSC">faust</span> (see section <a href="../7-audioObjects#faustObjects">faustObjects</a>) and <span class="OSC">audioio</span> (see section <a href="../7-audioObjects#audioioObjects">audioioObjects</a>).</p>
<p>Audio objects support the following messages:</p>
<div class="rail">
<span class="railtitle">audioMsgs</span>
<br /><script>
ComplexDiagram(
    Sequence (Choice (0, 'connect', 'disconnect'), OneOrMore (Choice (0, Sequence (Comment ('1'), NonTerminal('destination')), Sequence (Comment ('2'), NonTerminal('int32'), ':', NonTerminal('destination'), ':', NonTerminal('int32')))))
).addTo()
</script>
</div>

<ul>
<li><span class="OSC">connect</span>: connect the outputs of the object to the destination inputs. <span class="OSC">destination</span> must be another audio object. Without  numeric prefix and suffix [1], the connexion may be subject of up or down mixing as specified by the <a href=https://www.w3.org/TR/webaudio/#channel-up-mixing-and-down-mixing>Web Audio API</a>. The destination supports regular expressions. The second form [2] connects an output channel to the a destination input channel. The first number refers to the target object channel, the second one to the destination channel. Channels are indexed from 1, using 0 is equivalent to all channels (that are then mixed together). See the examples below.</li>
<li><span class="OSC">disconnect</span>: disconnect the outputs of the object from the destination inputs. Note that errors (e.g. no existing connection with the destination) are silently ignored.</li>
</ul>
<p><span class="example">Example</span>
Connect the first channel of an audio object to the second channel of the audio output :</p>
<pre><code class="language-inscore">/ITL/scene/obj connect '1:audioOutput:2';
</code></pre>
<p>Connect all channels of an audio object to the first channel of the audio output :</p>
<pre><code class="language-inscore">/ITL/scene/obj connect '0:audioOutput:1';
</code></pre>
<p><span class="note">Note: </span>
The messages <span class="OSC">/ITL/scene/obj connect '0:dest:0';</span> is equivalent to <span class="OSC">/ITL/scene/obj connect dest;</span></p>
<p><span class="note">Note: </span>
The <span class="OSC">connect</span> message assumes that the source and destination are located in the same hierarchy (i.e. they have the same parent). </p>
<div class="rail">
<span class="railtitle">audiogetMsgs</span>
<br /><script>
ComplexDiagram(
    Sequence ('get', Choice (0, 'connect', 'in', 'out'))
).addTo()
</script>
</div>

<ul>
<li><span class="OSC">in</span>: gives the number of inputs of the audio object</li>
<li><span class="OSC">out</span>: gives the number of outputs of the audio object</li>
</ul>
<h2 id="faust-objects">Faust objects</h2>
<p><a name="faustObjects"></a></p>
<p><a href=https://faust.grame.fr/>Faust</a> is a functional programming language for sound synthesis and audio processing.
Faust objects are available, providing that the Faust library has been loaded.</p>
<p><span class="warning">Warning</span> 
A page containing Faust objects require an https connection, unless it runs on localhost.</p>
<h3 id="creating-a-faust-object">Creating a Faust object</h3>
<p><a name="webFaust"></a></p>
<p>The <span class="OSC">faust</span> or <span class="OSC">faustf</span> types must be used to create a Faust object.</p>
<p><span class="note">Note: </span>
The <span class="OSC">faust</span> type exists with the native version but to load a pre-compiled DSP. <span class="OSC">faustdsp</span> and <span class="OSC">faustdspf</span> types are not supported.</p>
<div class="rail">
<span class="railtitle">setFaust</span>
<br /><script>
ComplexDiagram(
    Sequence ('set', Choice (0, Sequence (Comment ('1'), 'faust', Optional  ( NonTerminal('int32')), NonTerminal('dspCode')), Sequence (Comment ('2'), 'faustf', Optional  ( NonTerminal('int32')), NonTerminal('dspFile')), Sequence (Comment ('3'), 'faustw', Optional  ( NonTerminal('int32')), NonTerminal('wasmFile'), NonTerminal('jsonFile'))))
).addTo()
</script>
</div>

<p>The expected arguments of the <span class="OSC">set</span> message are:</p>
<ul>
<li>an optional integer that indicates a number of voices used to create a polyphonic DSP (see section <a href="../7-audioObjects#webFaustPoly">webFaustPoly</a>). Note that when present, a polyphonic DSP is created even if equal to 1.</li>
<li>1: Faust DSP code (see the <a href=https://faustdoc.grame.fr/>Faust language</a> for more information).</li>
<li>2: a Faust DSP file.</li>
<li>3: a Faust pre-compiled wasm file and the associated json file. Note that theses files can be generated using the <span class="OSC">get wasm</span> message (see section <a href="../7-audioObjects#webFaustMsgs">webFaustMsgs</a>). </li>
</ul>
<p>By default, a Faust DSP appears as a browsable block diagram.</p>
<p><span class="note">Note: </span>
The Faust language uses characters that have a special meaning in HTML: for example, with the split operator <span class="OSC">&lt;:</span>, the '<span class="OSC">&lt;</span>' character will be interpreted as an opening HTML tag and you should use HTML escapes (e.g. <span class="OSC">&amp;lt;</span> instead of <span class="OSC">&lt;</span>). This is necessary for inline DSP code only, DSP files are not concerned.</p>
<h3 id="faust-messages">Faust messages</h3>
<p><a name="webFaustMsgs"></a></p>
<p>Faust objects are active by default, i.e. the output signals is computed whatever the audio connection state. 
However, it is possible to disable the signals computation when it is not needed (e.g. for objects that are only temporarily active), which allows a large number of faust objects to be embedded in a score, while saving a significant CPU. The <span class="OSC">compute</span> message is provided in this intend.</p>
<div class="rail">
<span class="railtitle">faustMsgs</span>
<br /><script>
ComplexDiagram(
    Choice (0, Sequence ('compute', NonTerminal('int32')), Sequence ('autoOff', NonTerminal('int32')))
).addTo()
</script>
</div>

<ul>
<li><span class="OSC">compute</span>: start or stop computing the audio signals. The parameter is a boolean value. Default value is 1.</li>
<li><span class="OSC">autoOff</span>: automatically switch buttons Faust UI elements back to off. The parameter is a boolean value. Default value is 0.</li>
</ul>
<p>Faust objects support the audio objects messages plus additional query messages:</p>
<div class="rail">
<span class="railtitle">faustgetMsgs</span>
<br /><script>
ComplexDiagram(
    Sequence ('get', Choice (0, 'ui', 'wasm'))
).addTo()
</script>
</div>

<ul>
<li><span class="OSC">ui</span>: gives the Faust processor parameters (see section <a href="../7-audioObjects#webFaustParams">webFaustParams</a>) i.e. for each parameter: its OSC address followed by the parameter UI type, a label, the minimum and maximum values and the parameter step.</li>
<li><span class="OSC">wasm</span>: generates the Faust dsp as a precompiled wasm file with the associated json file. The Faust object name is used for the files name. On output, the files <span class="OSC">xxx.wasm</span> and <span class="OSC">xxx.json</span> should be present in the local download folder (where <span class="OSC">xxx</span> is the Faust object name).</li>
</ul>
<h3 id="faust-objects-parameters">Faust objects parameters</h3>
<p><a name="webFaustParams"></a></p>
<p>A Faust DSP code can declare UI elements that are used by <strong>architecture files</strong> to build controllers providing users with dynamic control of the DSP parameters. In INScore, DSP UI elements are used to extend the Faust object address space. For example, when a DSP code declares a UI element named 'Volume', a Faust object which address is <span class="OSC">/ITL/scene/dsp</span> is extended as <span class="OSC">/ITL/scene/dsp/Volume</span>.</p>
<p>Faust parameters support two types of messages:</p>
<div class="rail">
<span class="railtitle">faustParamMsgs</span>
<br /><script>
ComplexDiagram(
    Choice (0, Sequence (Comment ('1'), NonTerminal('float32')), Sequence (Comment ('2'), 'get'))
).addTo()
</script>
</div>

<ul>
<li>1: set the parameter value</li>
<li>2: gives the parameter value</li>
</ul>
<h3 id="polyphonic-objects">Polyphonic objects</h3>
<p><a name="webFaustPoly"></a></p>
<p>Polyphonic objects (i.e. Faust objects created using the optional voice number) support additional messages:</p>
<div class="rail">
<span class="railtitle">faustPolyMsgs</span>
<br /><script>
ComplexDiagram(
    Choice (0, Sequence (Choice (0, 'keyOn', 'keyOff'), NonTerminal('chan'), NonTerminal('pitch'), NonTerminal('vel')), 'allNotesOff')
).addTo()
</script>
</div>

<ul>
<li><span class="OSC">keyOn</span> and <span class="OSC">keyOff</span> messages take 3 integer parameters: a MIDI channel, the note pitch and the velocity.</li>
<li><span class="OSC">allNotesOff</span>: similar to MIDI all notes off message</li>
</ul>
<h2 id="audio-input-output">Audio Input / Output</h2>
<p><a name="audioioObjects"></a></p>
<p>Audio input / output objects are provided as audio object (see section <a href="../7-audioObjects#audioObjects">audioObjects</a>) to represent the physical audio inputs and outputs, in order to homogenize the connection process.
An audio input / output type is <span class="OSC">audioio</span>. It is created with a number of inputs and outputs as arguments.</p>
<div class="rail">
<span class="railtitle">audioioMsgs</span>
<br /><script>
ComplexDiagram(
    Sequence ('set', 'audioio', NonTerminal('int32'), NonTerminal('int32'))
).addTo()
</script>
</div>

<p><span class="note">Note:</span>
The current Javascript implementation automatically creates an audio input objet named <span class="OSC">audioInput</span> and an audio output object named  <span class="OSC">audioOutput</span>. Thus the names <span class="OSC">audioInput</span> and <span class="OSC">audioOutput</span> are reserved and you must not use them. 
<span class="OSC">audioOutput</span> and <span class="OSC">audioInput</span> are created on audio request only, i.e. when an audio object is created (<span class="OSC">audio</span>, <span class="OSC">video</span> or <span class="OSC">faust</span>). </p>
<p><span class="note">Note: About I/O OSC addresses</span>
Since audio connections can only be made between objects that are in the same hierarchy, <span class="OSC">audioOutput</span> and <span class="OSC">audioInput</span> objects are created in all hierarchies that contain audio objects. For example, by creating an <span class="OSC">faust</span> object in the <span class="OSC">/ITL/scene/folder</span> hierarchy, audio I/O will be created at <span class="OSC">/ITL/scene/folder/audioInput</span> and <span class="OSC">/ITL/scene/folder/audioOutput</span>. Thus audio I/O objects may appear at different levels of a scene.</p>
<h3 id="audio-input">Audio Input</h3>
<p><a name="audioInput"></a></p>
<p>By default, the <span class="OSC">audioInput</span> object is created with 0 inputs. It must be explicitly initialized using the <span class="OSC">init</span> message. On success, the <span class="OSC">ready</span> event is triggered and the number of input channels is set, otherwise an <span class="OSC">error</span> event is triggered.
This initialization is intended to avoid capturing the audio input when not used. </p>
<p><span class="example">Example</span></p>
<pre><code class="language-inscore">/ITL/scene/audioInput watch ready ( do something to use the audio input ); 
/ITL/scene/audioInput watch error ( do something else ); 
/ITL/scene/audioInput init;
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../6-MIDI/" class="btn btn-neutral float-left" title="MIDI support"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../8-communication/" class="btn btn-neutral float-right" title="Communication">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p><a href="https://inscore.grame.fr">INscore projects</a> Copyright &copy; 2019-2021 <a href="http://www.grame.fr">Grame-CNCM</a></p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../6-MIDI/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../8-communication/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="/js/inscore.js" defer></script>
      <script src="/js/pubs.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
